<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Acceso | LibraryPro ITSC</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <script src="https://unpkg.com/lucide@latest" defer></script>

    <style>
      /* Variables CSS - Adaptadas o eliminadas en favor de Bootstrap.
         Algunas variables de color se pueden sobrescribir en Bootstrap si se usa Sass. */
      :root {
        --primary-color: #e63946; /* Rojo vibrante */
        --primary-dark: #c31e2b; /* Rojo más oscuro */
        --dark-bg-1: #1a1a2e; /* Fondo principal oscuro */
        --dark-bg-2: #16213e; /* Fondo secundario oscuro */
        --dark-bg-3: #0f3460; /* Fondo terciario oscuro */
        --text-light: #e0e0e0; /* Color de texto claro */
        --text-white: #ffffff; /* Color de texto blanco */
        --border-color: #4a4a6a; /* Color de borde */
        --input-bg: #2a2a4a; /* Fondo de inputs */
        --font-family: "Poppins", sans-serif; /* Fuente principal */
        --transition-speed: 0.3s; /* Velocidad de transición */
        --border-radius: 12px; /* Radio de borde global */
        --form-padding: 40px; /* Relleno del formulario */
      }

      body {
        font-family: var(--font-family);
        background-color: var(--dark-bg-1); /* Fondo principal oscuro */
        color: var(--text-light); /* Texto claro */
        min-height: 100vh;
        display: flex;
        overflow: hidden;
      }

      /* Estilos para el panel visual - Adaptado a Bootstrap */
      .visual-pane {
        background: linear-gradient(
            160deg,
            var(--dark-bg-3) 0%,
            var(--dark-bg-2) 50%,
            var(--dark-bg-1) 100%
          ),
          url("https://images.unsplash.com/photo-1507842217343-583bb7270b66?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1590&q=80");
        background-blend-mode: overlay;
        background-size: cover;
        background-position: center;
        position: relative;
        overflow: hidden;
      }

      .visual-pane::before {
        content: "";
        position: absolute;
        top: -50px;
        left: -50px;
        right: -50px;
        bottom: -50px;
        background: rgba(15, 52, 96, 0.4);
        backdrop-filter: blur(3px) brightness(0.7);
        z-index: 1;
      }

      .visual-content {
        position: relative;
        z-index: 2;
        color: var(--text-white);
        animation: fadeIn 1.5s ease forwards;
      }

      .visual-content img {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        margin-bottom: 25px;
        border: 3px solid rgba(255, 255, 255, 0.6);
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        object-fit: cover;
      }

      .visual-content h2 {
        font-size: 36px;
        font-weight: 700;
        margin-bottom: 15px;
        text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.5);
        letter-spacing: 1px;
      }

      .visual-content p {
        font-size: 18px;
        font-weight: 300;
        max-width: 400px;
        line-height: 1.6;
        opacity: 0.9;
      }

      /* Estilos para el panel del formulario */
      .form-pane {
        background-color: var(--dark-bg-1);
        padding: var(--form-padding);
        overflow-y: auto;
      }

      .form-content {
        max-width: 400px;
        width: 100%;
        text-align: center;
        animation: slideInRight 1s ease forwards;
        opacity: 0;
        padding: 20px;
        border-radius: var(--border-radius);
      }

      /* Animaciones */
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      @keyframes slideInRight {
        from {
          opacity: 0;
          transform: translateX(50px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      /* Estilos para elementos del formulario - Adaptados a Bootstrap */
      .form-control {
        background-color: var(--input-bg); /* Fondo de inputs */
        border: 1.5px solid var(--border-color); /* Borde de inputs */
        color: var(--text-light); /* Color de texto claro */
        border-radius: var(--border-radius); /* Radio de borde global */
        padding-left: 3.5rem; /* Espacio para el icono */
        height: 50px; /* Altura consistente */
      }

      .form-control:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 10px rgba(230, 57, 70, 0.3);
        background-color: var(--input-bg);
        color: var(--text-light);
      }

      /* Clase para inputs inválidos */
      .form-control.is-invalid {
        border-color: var(--primary-color); /* Borde rojo para input inválido */
        box-shadow: 0 0 5px rgba(230, 57, 70, 0.5);
      }

      .input-group-text {
        background-color: transparent;
        border: none;
        color: #777;
      }

      .password-toggle {
        background: none;
        border: none;
        color: #777;
        padding: 0.5rem;
        cursor: pointer;
        transition: color var(--transition-speed) ease;
      }
      .password-toggle:hover {
        color: var(--primary-color);
      }

      /* Mensajes de error */
      .error-message {
        color: var(--primary-color);
        font-weight: 500;
        min-height: 1.2em;
        opacity: 0;
        transform: translateY(-5px);
        transition: opacity var(--transition-speed) ease,
          transform var(--transition-speed) ease;
        font-size: 14px;
      }
      .error-message.show {
        opacity: 1;
        transform: translateY(0);
      }

      /* Clases de utilidad */
      .bg-red-600 {
        background-color: var(--primary-color) !important;
      }
      .hover\:bg-red-700:hover {
        background-color: var(--primary-dark) !important;
      }
      .rounded-xl {
        border-radius: var(--border-radius) !important;
      }
      .shadow-lg {
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.175) !important;
      }
      .hover\:shadow-xl:hover {
        box-shadow: 0 1rem 3rem rgba(0, 0, 0, 0.175) !important;
      }
      .focus\:ring-2:focus {
        box-shadow: 0 0 0 0.25rem rgba(230, 57, 70, 0.5) !important;
      }
      .text-3xl {
        font-size: 1.875rem !important; /* 30px */
      }
      .font-semibold {
        font-weight: 600 !important;
      }
      .mb-10 {
        margin-bottom: 2.5rem !important; /* 40px */
      }
      .py-4 {
        padding-top: 1.5rem !important;
        padding-bottom: 1.5rem !important;
      }
      .px-6 {
        padding-left: 1.5rem !important;
        padding-right: 1.5rem !important;
      }
      .pl-14 {
        padding-left: 3.5rem !important; /* 56px */
      }
      .pr-6 {
        padding-right: 1.5rem !important;
      }
      .tracking-wide {
        letter-spacing: 0.025em !important;
      }
      .w-full {
        width: 100% !important;
      }
      .ml-1 {
        margin-left: 0.25rem !important;
      }
      .mt-8 {
        margin-top: 2rem !important;
      }
      .text-sm {
        font-size: 0.875rem !important;
      }
      .text-gray-400 {
        color: #9ca3af !important;
      }
      .text-red-500 {
        color: var(--primary-color) !important;
      }

      /* Responsive */
      @media (max-width: 850px) {
        .visual-pane {
          display: none; /* Oculta el panel visual en pantallas pequeñas */
        }
        .form-pane {
          flex: 1; /* Ocupa todo el ancho */
          padding: var(--form-padding);
        }
      }
      @media (max-width: 480px) {
        .form-content h1 {
          font-size: 26px;
          margin-bottom: 30px;
        }
        .form-control {
          padding: 14px 18px 14px 50px;
        }
        .btn {
          padding: 14px 0;
          font-size: 16px;
        }
        .form-pane {
          padding: 20px;
        }
      }
    </style>
  </head>
  <body>
    <div class="login-container d-flex w-100 vh-100">
      <section
        class="visual-pane d-none d-lg-flex flex-grow-1 flex-column justify-content-center align-items-center text-center p-5"
        aria-hidden="true"
      >
        <div class="visual-content">
          <img
            src="https://placehold.co/120x120/0f3460/ffffff?text=Logo"
            alt="Logo de LibraryPro ITSC: Un libro estilizado"
            onerror="this.onerror=null;this.src='https://placehold.co/120x120/0f3460/ffffff?text=Logo';"
            class="mb-4"
          />
          <h2 class="text-white fw-bold mb-3">Bienvenido a LibraryPro</h2>
          <p class="text-white fw-light mx-auto" style="max-width: 400px">
            Tu portal de acceso al conocimiento y los recursos bibliotecarios
            del ITSC.
          </p>
        </div>
      </section>

      <main
        class="form-pane d-flex flex-grow-1 justify-content-center align-items-center"
        role="main"
      >
        <div class="form-content">
          <h1 class="text-white text-3xl font-semibold mb-10">
            Iniciar Sesión
          </h1>
          <form id="loginForm" novalidate>
            <div class="mb-4">
              <label for="usuario" class="sr-only">Usuario</label>
              <div class="input-group">
                <span class="input-group-text">
                  <i data-lucide="user-round"></i>
                </span>
                <input
                  type="text"
                  id="usuario"
                  name="usuario"
                  placeholder="Usuario"
                  required
                  autocomplete="username"
                  aria-describedby="loginErrorMsg"
                  class="form-control"
                />
              </div>
            </div>

            <div class="mb-4">
              <label for="password" class="sr-only">Contraseña</label>
              <div class="input-group">
                <span class="input-group-text">
                  <i data-lucide="key-round"></i>
                </span>
                <input
                  type="password"
                  id="password"
                  name="password"
                  placeholder="Contraseña"
                  required
                  autocomplete="current-password"
                  aria-describedby="loginErrorMsg"
                  class="form-control"
                />
                <button
                  type="button"
                  id="togglePassword"
                  class="password-toggle"
                  aria-label="Mostrar u ocultar contraseña"
                >
                  <i data-lucide="eye"></i>
                </button>
              </div>
            </div>

            <p
              id="loginErrorMsg"
              class="error-message text-red-500 text-center mb-3 small"
              role="alert"
              aria-live="assertive"
            ></p>
            <button
              type="submit"
              class="btn bg-red-600 hover:bg-red-700 text-white fw-bold w-100 py-3 rounded-xl shadow-lg hover:shadow-xl text-uppercase tracking-wide"
            >
              Acceder
            </button>
          </form>
          <p class="link text-sm text-gray-400 mt-4">
            ¿Problemas? Contacta a
            <a
              href="mailto:info@itsc.edu.do"
              class="text-red-500 hover:underline ms-1"
              >soporte</a
            >.
          </p>
        </div>
      </main>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        "use strict";

        const form = document.getElementById("loginForm");
        const usuarioInput = document.getElementById("usuario");
        const passwordInput = document.getElementById("password");
        const errorMsg = document.getElementById("loginErrorMsg");
        const togglePasswordBtn = document.getElementById("togglePassword");
        const passwordIcon = togglePasswordBtn.querySelector("i");

        // Inicializa los iconos de Lucide
        lucide.createIcons();

        // Manejo del botón de mostrar/ocultar contraseña
        togglePasswordBtn.addEventListener("click", function () {
          const type =
            passwordInput.getAttribute("type") === "password"
              ? "text"
              : "password";
          passwordInput.setAttribute("type", type);
          passwordIcon.setAttribute(
            "data-lucide",
            type === "password" ? "eye" : "eye-off"
          );
          // Vuelve a crear los iconos para que el cambio se visualice
          lucide.createIcons();
          // Anuncia el cambio para lectores de pantalla
          togglePasswordBtn.setAttribute(
            "aria-label",
            type === "password" ? "Mostrar contraseña" : "Ocultar contraseña"
          );
        });

        // Función para mostrar mensajes de error
        const showError = (message, inputElement = null) => {
          errorMsg.textContent = message;
          errorMsg.classList.add("show");
          if (inputElement) {
            inputElement.classList.add("is-invalid"); // Clase de Bootstrap para error
            inputElement.focus();
          }
          errorMsg.setAttribute("aria-live", "assertive"); // Anuncia inmediatamente
        };

        // Función para ocultar mensajes de error
        const hideError = () => {
          errorMsg.classList.remove("show");
          errorMsg.textContent = "";
          usuarioInput.classList.remove("is-invalid"); // Clase de Bootstrap para error
          passwordInput.classList.remove("is-invalid"); // Clase de Bootstrap para error
          errorMsg.removeAttribute("aria-live");
        };

        // Limpiar errores cuando el usuario empieza a escribir de nuevo
        usuarioInput.addEventListener("input", hideError);
        passwordInput.addEventListener("input", hideError);

        // Manejo del envío del formulario
        form.addEventListener("submit", async function (event) {
          event.preventDefault(); // Previene el envío por defecto

          const usuario = usuarioInput.value.trim();
          const password = passwordInput.value.trim();

          hideError(); // Limpia errores previos

          if (!usuario) {
            showError("El usuario es requerido.", usuarioInput);
            return;
          }
          if (!password) {
            showError("La contraseña es requerida.", passwordInput);
            return;
          }

          // --- Simulación de login (SOLO PARA DEMOSTRACIÓN) ---
          if (usuario.toLowerCase() === "virtual" && password === "123456") {
            sessionStorage.setItem("usuario", usuario);
            window.location.replace("principal.html"); // Redirige a una página principal
          } else {
            showError(
              "Credenciales incorrectas. Inténtalo de nuevo.",
              passwordInput
            );
            passwordInput.value = ""; // Limpia el campo de contraseña por seguridad
          }
        });
      });
    </script>
  </body>
</html>
